name: one-shot
version: "1.0"
description: Complete a single task from start to finish with PR

settings:
  max-retry: 3
  timeout-minutes: 60
  track-progress: true
  git:
    enabled: true
    worktree: true
    auto-commit: true
    branch-prefix: "agentic"

variables:
  - name: task
    type: string
    required: true
    description: Task description or prompt
  - name: create_pr
    type: boolean
    required: false
    default: true
    description: Whether to create a PR

steps:
  - name: create-branch
    type: prompt
    model: haiku
    prompt: /agentic-sdlc:git-branch {{ variables.type }}

  - name: execute-task
    type: prompt
    prompt: |
      Complete the following task:

      {{ variables.task }}

      Guidelines:
      - Analyze the codebase to understand context
      - Make necessary changes following project conventions
      - Use /agentic-sdlc:git-commit to commit changes

  - name: review
    type: prompt
    prompt: /agentic-sdlc:sdlc-review "" major

  - name: create-pr
    type: conditional
    condition: "variables.create_pr"
    then:
      - name: open-pr
        type: prompt
        prompt: /agentic-sdlc:git-pr
